generator client {
  provider = "prisma-client-js"
  previewFeatures = ["selectRelationCount", "referentialActions"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          String    @id @default(cuid())
  createdAt   DateTime  @default(now())
  firstName   String
  lastName    String
  email       String    @unique
  password    String
  birthDate   DateTime
  gender      String
  height      Int
  weight      Int
  role        Role   @default(USER)
  isVerified  Boolean  @default(false)
  userWorkouts UserWorkout[]
}

enum Role {
  USER
  ADMIN
}

model ExerciseCategory {
  id          String    @id @default(cuid())
  name        String
  exercises   Exercise[]
}

model Exercise {
  id                String           @id @default(cuid())
  name              String
  description       String
  image             String?
  unit              String
  exerciseCategory  ExerciseCategory @relation(fields: [exerciseCategoryId], references: [id])
  exerciseCategoryId String
  userWorkoutExercises     UserWorkoutExercise[]
}

model TrainedUserWorkout {
  id                String           @id @default(cuid())
  createdAt         DateTime  @default(now())
  hasStarted        Boolean @default(true)
  isFinished        Boolean @default(false)
  isBaseWorkout     Boolean
  pausedAt          DateTime
  userWorkoutExercises  UserWorkoutExercise[]
  userWorkout          UserWorkout         @relation(fields: [userWorkoutId], references: [id])
  userWorkoutId        String
}

model UserWorkout {
  id                String           @id @default(cuid())
  user              User             @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId            String
  name              String
  isPublic          Boolean          @default(false)
  trainedUserWorkouts TrainedUserWorkout[]
}

model UserWorkoutExercise {
  id                String           @id @default(cuid())
  exercise          Exercise         @relation(fields: [exerciseId], references: [id])
  exerciseId        String
  trainedWorkout           TrainedUserWorkout      @relation(fields: [trainedWorkoutId], references: [id], onDelete: Cascade)
  trainedWorkoutId         String
  exerciseSets      ExerciseSet[]
}

model ExerciseSet {
  id                 String           @id @default(cuid())
  reps               Int
  weight             Int
  setNumber          Int
  userWorkoutExercise   UserWorkoutExercise @relation(fields: [userWorkoutExerciseId], references: [id], onDelete: Cascade)
  userWorkoutExerciseId String
  isChecked         Boolean @default(false)
}
